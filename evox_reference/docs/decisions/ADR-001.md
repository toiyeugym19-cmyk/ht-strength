# ADR-001: External Persistent State for Agent Memory

## Status
Accepted

## Context
LLMs have no memory between sessions. Every new invocation is a blank page. This isn't a bug to fix â€” it's a fundamental constraint of the architecture.

When an AI agent starts a new session, it loses everything: every conversation, every decision, every piece of context. You start over every single time.

## Decision
**State must live outside the model**, in a persistent layer the agent reads on boot.

We use Convex as the shared brain for all agents. Agent identity, working memory, and long-term memory are stored in Convex tables and read during the agent boot sequence.

### Implementation
- `agentMappings` table: Maps agent names to Convex IDs and Linear user IDs
- Agent boot protocol reads SOUL.md (identity) and WORKING.md (context) on every session start
- All state changes are persisted to Convex immediately

### Attribution Model
Attribution comes from the **caller** (the agent making the request), not from the Linear API key. This allows multiple agents to share infrastructure while maintaining individual identity.

## Consequences
### Positive
- Agents maintain continuity across sessions
- Cold start to productive: ~30 seconds
- Swap runtime (Claude Code, Cursor, future daemons), keep memory

### Negative
- Requires discipline to persist state changes
- Boot sequence adds latency to first action
- Convex becomes a critical dependency

## References
- Truth 1: LLMs have no memory between sessions
- `convex/schema.ts`: agentMappings table
